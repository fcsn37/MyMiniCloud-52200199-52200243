events {}
http {
 resolver 127.0.0.11 valid=5s;
 server {
 listen 80;
 # Web tĩnh
 location / {
 proxy_pass http://web-frontend-server:80;
 proxy_set_header Host $host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header X-Forwarded-Proto $scheme;
 }
 # App API (strip /api/)
 location /api/ {
 proxy_pass http://application-backend-server:8081/;
 proxy_set_header Host $host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header X-Forwarded-Proto $scheme;
 }
 # Keycloak
 location /auth/ {
 proxy_pass http://authentication-identity-server:8080/;
 proxy_set_header Host $host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 proxy_set_header X-Forwarded-Proto $scheme;
 }
 location /student/ {
# Chuyển hướng tới API /student của backend
proxy_pass http://application-backend-server:8081/student;
# Giữ các headers
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
}
 }
}
